<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Oppty Admin | Corporate Portal</title>
     <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/12.9.0/firebase-app.js";
        import { getFirestore } from "https://www.gstatic.com/firebasejs/12.9.0/firebase-firestore.js";
        import { getAnalytics } from "https://www.gstatic.com/firebasejs/12.9.0/firebase-analytics.js";

        const firebaseConfig = {
            apiKey: "AIzaSyB5uyEKwSXsy9lPyG8fXP6jUTDEMWjqe7Y",
            authDomain: "lokeshbatta-e5027.firebaseapp.com",
            projectId: "lokeshbatta-e5027",
            storageBucket: "lokeshbatta-e5027.firebasestorage.app",
            messagingSenderId: "760264623454",
            appId: "1:760264623454:web:dba33f6524ac698298bbcf",
            measurementId: "G-N0F70EX5N6"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);
        getAnalytics(app);

        // Make Firestore globally accessible for future migration
        window.firebaseDB = db;
    </script>
    <style>
        :root {
            --brand: #ff9f43;
            --brand-soft: rgba(255, 159, 67, 0.1);
            --bg-main: #f8fafc;
            --sidebar-bg: #ffffff;
            --text-dark: #1e293b;
            --text-muted: #64748b;
            --border: #e2e8f0;
            --success: #22c55e;
            --danger: #ef4444;
        }

        * {
            margin: 0; padding: 0; box-sizing: border-box;
            font-family: 'Inter', 'Segoe UI', sans-serif;
        }

        body {
            min-height: 100vh;
            background: var(--bg-main);
            color: var(--text-dark);
            display: flex;
        }

        /* SIDEBAR */
        .sidebar {
            width: 240px;
            background: var(--sidebar-bg);
            border-right: 1px solid var(--border);
            padding: 30px 15px;
            display: flex;
            flex-direction: column;
            position: fixed;
            height: 100vh;
        }

        .sidebar img {
            height: 35px;
            margin: 0 auto 40px;
            display: block;
        }

        .menu {
            display: flex;
            flex-direction: column;
            gap: 6px;
        }

        .menu button {
            background: transparent;
            color: var(--text-muted);
            border: none;
            padding: 12px 16px;
            border-radius: 10px;
            cursor: pointer;
            text-align: left;
            font-size: 14px;
            font-weight: 500;
            transition: 0.2s;
        }

        .menu button:hover {
            background: var(--bg-main);
            color: var(--text-dark);
        }

        .menu button.active {
            background: var(--brand-soft);
            color: var(--brand);
            font-weight: 700;
        }

        /* MAIN CONTENT */
        .main {
            flex: 1;
            margin-left: 240px;
            padding: 40px;
        }

        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid var(--border);
        }

        .header h2 { font-weight: 800; color: var(--text-dark); }

        .header-right button {
            background: #fff;
            color: var(--text-dark);
            border: 1px solid var(--border);
            padding: 8px 16px;
            border-radius: 8px;
            font-size: 13px;
            font-weight: 600;
            cursor: pointer;
            transition: 0.2s;
        }

        .header-right button:hover { background: #f1f5f9; }

        /* CARDS */
        .card {
            background: #fff;
            border-radius: 16px;
            padding: 24px;
            margin-bottom: 24px;
            border: 1px solid var(--border);
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05);
        }

        .card h3 {
            font-size: 14px;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            color: var(--text-muted);
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        /* FORMS & INPUTS */
        input {
            padding: 12px 16px;
            border-radius: 10px;
            border: 1px solid var(--border);
            outline: none;
            background: #fff;
            margin-right: 10px;
            font-size: 14px;
            transition: 0.2s;
        }

        input:focus { border-color: var(--brand); box-shadow: 0 0 0 3px var(--brand-soft); }

        button.action {
            padding: 10px 18px;
            border-radius: 10px;
            border: none;
            background: var(--brand);
            color: #fff;
            font-weight: 700;
            cursor: pointer;
            font-size: 13px;
            transition: 0.2s;
        }

        button.action:hover { transform: translateY(-1px); box-shadow: 0 4px 12px var(--brand-soft); }

        /* DATA TABLE */
        table {
            width: 100%;
            border-collapse: separate;
            border-spacing: 0 8px;
        }

        th {
            text-align: left;
            padding: 12px 16px;
            color: var(--text-muted);
            font-size: 12px;
            font-weight: 600;
            text-transform: uppercase;
        }

        td {
            padding: 16px;
            background: #fff;
            border-top: 1px solid var(--border);
            border-bottom: 1px solid var(--border);
            font-size: 14px;
        }

        td:first-child { border-left: 1px solid var(--border); border-radius: 12px 0 0 12px; }
        td:last-child { border-right: 1px solid var(--border); border-radius: 0 12px 12px 0; }

        .green { color: var(--success); font-weight: 600; }
        .red { color: var(--danger); font-weight: 600; }

        /* TOGGLE BUTTONS */
        .toggle {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 6px;
            font-size: 11px;
            font-weight: 700;
            background: #f1f5f9;
            color: var(--text-muted);
            cursor: pointer;
        }

        .toggle.on { background: #dcfce7; color: var(--success); }

        /* SECTIONS */
        .section { display: none; }
        .section.active { display: block; }
    </style>
</head>

<body>

    <div class="sidebar">
        <img src="imgs/322343.png">
        <div class="menu">
            <button class="active" onclick="showSection('users',this)">üë§ Employee Management</button>
            <button onclick="showSection('alerts',this)">‚ö† System Alerts</button>
            <button onclick="showSection('leaveRequests',this)">üì© Leave Requests</button>
            <button onclick="showSection('analytics',this)">üìä Analytics</button>
            <button onclick="showSection('breaks',this)">‚è± Break Logs</button>
            <button onclick="showSection('leave',this)">üèñ Leave Overview</button>
        </div>
    </div>

    <div class="main">
        <div class="header">
            <h2>Admin Dashboard</h2>
            <div class="header-right">
                <button onclick="location.href='index.html'">‚Üê Back</button>
                <button onclick="logout()">Logout</button>
            </div>
        </div>

        <div class="section active" id="users">
            <div class="card">
    <h3>Add New Personnel</h3>
    <input id="uname" placeholder="Username">
    <input id="upass" placeholder="Password">
    <input id="uIdNum" placeholder="ID Number (e.g. 101)" style="width: 150px;">
    <button class="action" onclick="addUser()">Add Employee</button>
</div>

            <div class="card">
                <h3>Employee Directory</h3>
                <input id="searchUser" placeholder="Filter by name..." onkeyup="renderUsers()" style="margin-bottom: 20px; width: 300px;">
                <button class="action" onclick="sendEmailReport()" style="margin-bottom: 15px; background: #4a90e2;">üìß Send Email Report</button>
                <table>
                    <thead>
    <tr>
        <th>ID</th> <th>User</th>
        <th>Status</th>
        <th>Break Type</th>
        <th>Active</th>
        <th>Break</th>
        <th>Limit</th>
        <th>Actions</th>
    </tr>
</thead>
                    <tbody id="userTable"></tbody>
                </table>
            </div>

            <div class="card">
                <h3>Employee Deep Dive</h3>
                <div id="userDetailBox" style="color: var(--text-muted); font-size: 14px;">
                    Select a Employee from the directory to inspect their profile and history.
                </div>
            </div>
        </div>

        <div class="section" id="alerts">
            <div class="card">
                <h3>Admin Security Alerts</h3>
                <ul id="adminAlertList" style="list-style: none; line-height: 2;"></ul>
            </div>
        </div>

        <div class="section" id="analytics">
    <div class="card">
        <h3>Break Statistics</h3>
        <button class="action" onclick="sendEmailReport()" style="margin-bottom: 15px; background: #4a90e2;">üìß Send Email Report</button>
        <div id="analyticsBox"></div>
    </div>
</div>
        <div class="section" id="breaks">
            <div class="card">
                <h3>Historical Break Logs</h3>
                <button class="action" onclick="downloadReport()" style="margin-bottom: 15px;">‚¨á Download CSV Report</button>
                <table>
                    <thead>
                        <tr>
                            <th>Employee</th>
                            <th>Type</th>
                            <th>Start</th>
                            <th>End</th>
                            <th>Status</th>
                        </tr>
                    </thead>
                    <tbody id="breakTable"></tbody>
                </table>
            </div>
        </div>

        <div class="section" id="leave">
            <div class="card">
                <h3>üìÖ Today's Attendance</h3>
                <div id="leaveSummary" style="display: flex; gap: 20px; margin-bottom: 25px;"></div>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                    <div class="card" style="background: #f0fdf4; border-color: #bbf7d0;">
                        <h4 class="green">üë®‚Äçüíª Currently Working</h4>
                        <ul id="workingList" style="list-style: none; margin-top: 15px; line-height: 2.2;"></ul>
                    </div>
                    <div class="card" style="background: #fef2f2; border-color: #fecaca;">
                        <h4 class="red">üèñ On Leave</h4>
                        <ul id="onLeaveList" style="list-style: none; margin-top: 15px; line-height: 2.2;"></ul>
                    </div>
                </div>
            </div>
        </div>

        <div class="section" id="leaveRequests">
            <div class="card">
                <h3>Leave Authorization</h3>
                <table>
                    <thead>
                        <tr>
                            <th>Employee</th>
                            <th>Date</th>
                            <th>Type</th>
                            <th>Status</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="adminLeaveTable"></tbody>
                </table>
            </div>
        </div>

    </div>

    <script src="firebase.js" type="module"></script>

<script type="module">
import { collection, addDoc, getDocs }
from "https://www.gstatic.com/firebasejs/12.9.0/firebase-firestore.js";

const usersRef = collection(window.db, "users");

window.addUser = async function(){
  const user = {
    username: uname.value,
    password: upass.value,
    idNum: uid.value
  };
  await addDoc(usersRef, user);
  loadUsers();
};

async function loadUsers(){
  const snap = await getDocs(usersRef);
  userList.innerHTML = "";
  snap.forEach(d=>{
    const u = d.data();
    userList.innerHTML += `<li>${u.username}</li>`;
  });
}

loadUsers();
</script>

    <script>
        
        // Use all your original script logic here
        // The IDs match the HTML structure above perfectly.
    
        /* SECURITY */
        if (localStorage.getItem("role") !== "admin") {
            location.href = "index.html";
        }

        let users = JSON.parse(localStorage.getItem("users")) || [];
        let breakLogs = JSON.parse(localStorage.getItem("breakLogs")) || [];
        let adminAlerts = JSON.parse(localStorage.getItem("adminAlerts")) || [];

        /* SIDEBAR */
        function showSection(id, btn) {
            document.querySelectorAll(".section").forEach(s => s.classList.remove("active"));
            document.getElementById(id).classList.add("active");
            document.querySelectorAll(".menu button").forEach(b => b.classList.remove("active"));
            btn.classList.add("active");
        }
function renderUsers() {
    let key = (searchUser?.value || "").toLowerCase();
    let html = "";

    users.forEach((u, i) => {
        if (!u.username.toLowerCase().includes(key)) return;

        html += `
        <tr>
            <td style="font-weight:700; color:var(--brand)">#${u.idNum || '---'}</td>
            <td>${u.username}</td>
            <td class="${u.status === "ONLINE" ? "green" : "red"}">${u.status}</td>
            <td>${u.breakType || "-"}</td>
            <td>${Math.floor(u.totalActive || 0)}m</td>
            <td>${Math.floor(u.totalBreak || 0)}m</td>
            <td>${u.lunchExceeded ? "‚ùå Exceeded" : "‚úî OK"}</td>
            <td>
                <span class="toggle ${u.status === "ONLINE" ? "on" : ""}"
                    onclick="toggleStatus(${i})">
                    ${u.status === "ONLINE" ? "ON" : "OFF"}
                </span>
                <button class="action" onclick="viewUserDetails('${u.username}')">View</button>
                <button class="action" onclick="editUser(${i})">Edit</button>
                
                <button class="action" onclick="deleteUser(${i})">Delete</button>
            </td>
        </tr>`;
    });

    userTable.innerHTML = html || `<tr><td colspan="8" style="text-align:center;opacity:0.6">No users</td></tr>`;
}
        function addUser() {
    // Check if all fields are filled
    if (!uname.value || !upass.value || !uIdNum.value) {
        alert("Please fill in Username, Password, and ID Number");
        return;
    }

    users.push({
        idNum: uIdNum.value, // Save the ID Number
        username: uname.value,
        password: upass.value,
        status: "ONLINE",
        breakType: null,
        totalActive: 0,
        totalBreak: 0,
        lunchExceeded: false
    });

    // Clear inputs
    uname.value = upass.value = uIdNum.value = "";
    saveUsers();
}

        function toggleStatus(i) {
            users[i].status = users[i].status === "ONLINE" ? "DISABLED" : "ONLINE";
            saveUsers();
        }

        function deleteUser(i) {
            users.splice(i, 1);
            saveUsers();
        }

        function saveUsers() {
            localStorage.setItem("users", JSON.stringify(users));
            renderUsers();
        }

       function editUser(index) {
    let oldName = users[index].username;
    let oldId = users[index].idNum || "";

    // 1. Edit Username
    let newName = prompt("Edit Username:", oldName);
    if (newName === null) return; // Cancelled
    if (newName.trim() === "") {
        alert("Username cannot be empty");
        return;
    }

    // 2. Edit ID Number
    let newId = prompt("Edit ID Number:", oldId);
    if (newId === null) return; // Cancelled

    // Check if new username already exists elsewhere
    if (users.some((u, i) => u.username === newName && i !== index)) {
        alert("Username already exists");
        return;
    }

    // Update the user object
    users[index].username = newName;
    users[index].idNum = newId;

    // Update references in break logs if name changed
    if (newName !== oldName) {
        breakLogs.forEach(b => {
            if (b.user === oldName) b.user = newName;
        });
        
        adminAlerts = adminAlerts.map(a =>
            a.includes(oldName) ? a.replace(oldName, newName) : a
        );
    }

    // Save all changes
    localStorage.setItem("users", JSON.stringify(users));
    localStorage.setItem("breakLogs", JSON.stringify(breakLogs));
    localStorage.setItem("adminAlerts", JSON.stringify(adminAlerts));

    alert("User updated successfully");
    renderUsers();
}

function viewUserDetails(username) {
    const u = users.find(x => x.username === username);
    const logs = breakLogs.filter(b => b.user === username);

    let logHtml = logs.map(l =>
        `${l.type} | ${l.start} ‚Üí ${l.end || "ACTIVE"}`
    ).join("<br>");

    userDetailBox.innerHTML = `
        <div style="background: var(--brand-soft); padding: 10px; border-radius: 8px; margin-bottom: 10px;">
            <b style="color: var(--brand)">Employee ID: #${u.idNum || 'N/A'}</b>
        </div>
        <b>User:</b> ${u.username}<br>
        <b>Status:</b> ${u.status}<br>
        <b>Current Break:</b> ${u.breakType || "None"}<br>
        <b>Total Active:</b> ${Math.floor(u.totalActive || 0)} mins<br>
        <b>Total Break:</b> ${Math.floor(u.totalBreak || 0)} mins<br><br>
        <b>Break History:</b><br>
        ${logHtml || "No history"}
    `;
}


        function renderAdminAlerts() {
            adminAlertList.innerHTML =
                adminAlerts.length
                    ? adminAlerts.slice(-10).map(a => `<li>${a}</li>`).join("")
                    : "<li>No alerts</li>";
        }


        function renderAnalytics() {
            let exceeded = users.filter(u => u.lunchExceeded).length;
            analyticsBox.innerHTML = `
        Total Users: <b>${users.length}</b><br>
        Active Users: <b>${users.filter(u => u.status === "ONLINE").length}</b><br>
        Exceeded Lunch Limit: <b>${exceeded}</b>
    `;
        }


        function renderBreakLogs() {
            breakTable.innerHTML = breakLogs.map(b => `
        <tr>
            <td>${b.user}</td>
            <td>${b.type}</td>
            <td>${b.start}</td>
            <td>${b.end || "-"}</td>
            <td class="${b.status === "ACTIVE" ? "green" : "red"}">${b.status}</td>
        </tr>
    `).join("") || `
        <tr><td colspan="5" style="text-align:center">No data</td></tr>`;
        }


        function downloadReport() {
            let csv = "User,Break Type,Start,End,Status\n";
            breakLogs.forEach(b => {
                csv += `${b.user},${b.type},${b.start},${b.end || "-"},${b.status}\n`;
            });
            let blob = new Blob([csv], { type: "text/csv" });
            let a = document.createElement("a");
            a.href = URL.createObjectURL(blob);
            a.download = "break_report.csv";
            a.click();
        }


        function logout() {
            localStorage.clear();
            location.href = "index.html";
        }

        function renderLeaveSection() {
    // 1. Filter users based on status
    // In your system, "ONLINE" = Working, "DISABLED" = On Leave/Inactive
    let workingUsers = users.filter(u => u.status === "ONLINE");
    let onLeaveUsers = users.filter(u => u.status === "DISABLED");

    // 2. Update the Top Cards
    leaveSummary.innerHTML = `
        <div style="background:#2a2a2a; padding:20px; border-radius:12px; flex:1; border-bottom:4px solid #7CFC98">
            <small style="color:#aaa;">Total Working</small><br>
            <strong style="font-size:28px;color:#ffffff">${workingUsers.length}</strong>
        </div>
        <div style="background:#2a2a2a; padding:20px; border-radius:12px; flex:1; border-bottom:4px solid #ff8a8a">
            <small style="color:#aaa;">Total On Leave</small><br>
            <strong style="font-size:28px;color:#ffffff">${onLeaveUsers.length}</strong>
        </div>
    `;

    // 3. Render the Name Lists
    // Working List
    workingList.innerHTML = workingUsers.length > 0 
        ? workingUsers.map(u => `<li>‚úÖ ${u.username}</li>`).join('')
        : `<li style="opacity:0.5;">No users working</li>`;

    // Leave List
    onLeaveList.innerHTML = onLeaveUsers.length > 0 
        ? onLeaveUsers.map(u => `<li>üìç ${u.username}</li>`).join('')
        : `<li style="opacity:0.5;">No users on leave</li>`;
}

        /* UPDATED ANALYTICS TO INCLUDE LEAVE DATA */
        function renderAnalytics() {
            let exceeded = users.filter(u => u.lunchExceeded).length;
            let working = users.filter(u => u.status === "ONLINE").length;
            let onLeave = users.filter(u => u.status === "DISABLED").length;

            analyticsBox.innerHTML = `
        <div style="line-height: 2;">
            Total Registered Users: <b>${users.length}</b><br>
            <span class="green">Currently Working: <b>${working}</b></span><br>
            <span class="red">Currently On Leave: <b>${onLeave}</b></span><br>
            <hr style="opacity:0.1; margin:10px 0;">
            Exceeded Lunch Limit: <b>${exceeded}</b>
        </div>
    `;
        }

        setInterval(() => {

            users = JSON.parse(localStorage.getItem("users")) || [];
            breakLogs = JSON.parse(localStorage.getItem("breakLogs")) || [];
            adminAlerts = JSON.parse(localStorage.getItem("adminAlerts")) || [];
            renderUsers();
            renderBreakLogs();
            renderAdminAlerts();
            renderAnalytics();
            renderLeaveSection();
        }, 2000);

        renderUsers();
        renderBreakLogs();
        renderAdminAlerts();
        renderAnalytics();
        renderLeaveSection();
        function renderAdminLeaveRequests() {
            // Get the requests from LocalStorage
            let leaveRequests = JSON.parse(localStorage.getItem("leaveRequests")) || [];
            let html = "";

            // Reverse so new requests appear at the top
            [...leaveRequests].reverse().forEach((req, index) => {
                // We need the real index from the original array for updating
                let originalIndex = leaveRequests.length - 1 - index;

                const statusClass = req.status === "Approved" ? "green" : (req.status === "Rejected" ? "red" : "");

                html += `
        <tr>
            <td><b>${req.user}</b></td>
            <td>${req.date}</td>
            <td>${req.type}</td>
            <td class="${statusClass}">${req.status}</td>
            <td>
                ${req.status === "Pending" ? `
                    <button class="action" onclick="updateLeaveStatus(${originalIndex}, 'Approved')" style="background:#7CFC98; color:#000;">Accept</button>
                    <button class="action" onclick="updateLeaveStatus(${originalIndex}, 'Rejected')" style="background:#ff8a8a; color:#000;">Reject</button>
                ` : `<span style="opacity:0.5">Decision Made</span>`}
            </td>
        </tr>`;
            });

            adminLeaveTable.innerHTML = html || `<tr><td colspan="5" style="text-align:center; padding:20px;">No leave requests found.</td></tr>`;
        }

        function updateLeaveStatus(index, newStatus) {
            let leaveRequests = JSON.parse(localStorage.getItem("leaveRequests")) || [];

            // 1. Update the request status
            leaveRequests[index].status = newStatus;
            localStorage.setItem("leaveRequests", JSON.stringify(leaveRequests));

            // 2. If approved, disable the user (mark them as on leave)
            if (newStatus === "Approved") {
                let allUsers = JSON.parse(localStorage.getItem("users")) || [];
                let userIdx = allUsers.findIndex(u => u.username === leaveRequests[index].user);
                if (userIdx !== -1) {
                    allUsers[userIdx].status = "DISABLED";
                    localStorage.setItem("users", JSON.stringify(allUsers));
                }
            }

            // 3. Refresh the UI
            renderAdminLeaveRequests();
            renderUsers();
        }
        setInterval(() => {
            users = JSON.parse(localStorage.getItem("users")) || [];
            // ... (other existing lines)

            renderAdminLeaveRequests(); // Add this line here!
        }, 2000);
async function sendEmailReport() {
    try {

        const users = JSON.parse(localStorage.getItem("users")) || [];
        const breakLogs = JSON.parse(localStorage.getItem("breakLogs")) || [];
        const leaveRequests = JSON.parse(localStorage.getItem("leaveRequests")) || [];
        const attendance = JSON.parse(localStorage.getItem("attendance")) || {};

        let csv = "ID,Username,Status,CheckIn,CheckOut,RegularBreak(min),LunchBreak(min),Leave Status\n";

        users.forEach(u => {
            let userAttendance = attendance[u.username] || {};
            let today = new Date().toDateString();
            let data = userAttendance[today] || {};

            let checkIn = data.checkIn ? new Date(data.checkIn).toLocaleTimeString() : "-";
            let checkOut = data.checkOut ? new Date(data.checkOut).toLocaleTimeString() : "-";

            let regular = 0, lunch = 0;
            breakLogs.forEach(b=>{
                if(b.user === u.username && b.end){
                    let mins = (new Date(b.end) - new Date(b.start))/60000;
                    if(b.type === "Regular") regular += mins;
                    if(b.type === "Lunch") lunch += mins;
                }
            });

            let leave = leaveRequests.find(l=>l.user===u.username && l.status==="Approved");
            let leaveStatus = leave ? leave.type : "No";

            csv += `${u.idNum},${u.username},${u.status},${checkIn},${checkOut},${Math.floor(regular)},${Math.floor(lunch)},${leaveStatus}\n`;
        });

        const base64 = btoa(unescape(encodeURIComponent(csv)));

        const uploadURL = "https://script.google.com/macros/s/AKfycbwqzAKi7LShRCIOT-MDDwRsklLsYkyZbASGUZ-zQ0MA1DK3QwPAENuqyd35GiV1gTdL/exec";

        // ‚≠ê REMOVE no-cors completely
        const response = await fetch(uploadURL, {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ file: base64 })
        });

        const result = await response.json(); // now works ‚úîÔ∏è

        if (!result.link) {
            alert("File upload failed ‚ùå");
            console.log(result);
            return;
        }

        await emailjs.send("service_7ddb0lg", "template_chededz", {
            report_date: new Date().toLocaleDateString(),
            download_link: result.link
        });

        alert("Report email sent successfully üìß");

    } catch (err) {
        console.error(err);
        alert("Error occurred. Check console.");
    }
}


    
    </script>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"></script>
<script type="text/javascript">
   (function(){
      emailjs.init("nY7WzlOGeTz5xsh0h"); // Replace with your Public Key
   })();
</script>
</body>

</html>